export const homePromo = {
  title: 'Комплексное сопровождение бизнеса',
  price: 'от 15 000 ₽ / месяц',
  description: 'Полный пакет юридических услуг, персональный менеджер и оперативное подключение к экспертам.',
  backgroundImage: null,
}

const servicesTree = [
  {
    slug: 'consultation',
    title: 'Консультация',
    description: 'Как провести  консультацию: Консультацию можно провести очно и удаленно. Для получения консультации необходимо связаться с экспертом по телефону, уточнить тему консультации, время и место встречи. Перед консультацией (или при удаленной консультации) желательно на электронную почту организации направить имеющиеся материалы (если они есть, и консультация будет проходить по ним). А далее с исследуемыми документами приехать на встречу. В настоящее время возможна выездная консультация - когда специалист приезжает к Вам в офис. ',
    details: [
      'Консультация позволяет выработать версии развития судебного процесса, связанного с назначением, производством и оценкой судебной экспертизы, а также оценить влияние выводов на позицию стороны. Она помогает развернуть судебный процесс в свою сторону и может проводиться как до назначения экспертизы, так и после неё.',
      'В ходе консультации может быть оценена необходимость производства судебной или несудебной экспертизы, направление исследования, объём решаемых вопросов и факторы, влияющие на достоверность результатов и последующее развитие процесса.',
      'После производства судебной экспертизы консультация помогает оценить полноту и достоверность выводов, определить необходимость повторной или дополнительной экспертизы и предположить их результаты.',
      'Консультация может быть как платной, так и бесплатной.',
      'Бесплатная консультация чаще всего устная (иногда письменная по общим вопросам) и не требует глубокого изучения конкретных объектов или обстоятельств дела. Она возможна, если вопрос не требует погружения или объекты исследования просты в анализе.',
      'Платные консультации предполагают более глубокое изучение объектов исследования или материалов дела (рецензия, письменная оценка). Они могут оформляться в виде «Справки эксперта» с описанием объектов и предварительным выводом.',
      'Письменная консультация помогает инициировать назначение судебной экспертизы, укрепить позицию в процессе или использоваться для досудебного урегулирования.',
    ],
    promo: {
      title: 'Экспресс-консультация эксперта',
      price: 'от 7 500 ₽',
      description: 'За 24 часа подготовим заключение по перспективам дела и дадим чек-лист следующего шага.',
      backgroundImage: 'https://images.unsplash.com/photo-1521791136064-7986c2920216?auto=format&fit=crop&w=1600&q=80',
    },
    children: [
      {
        slug: 'case-audit',
        title: 'Аудит материалов дела',
        description: 'Проверим корректность собранных документов и оценим, какие исследования усилят позицию.',
        details: [
          'Эксперт анализирует имеющуюся переписку, заключения и первичные документы, чтобы определить, какие доказательства стоит запросить дополнительно.',
        ],
        children: [],
      },
      {
        slug: 'expert-selection',
        title: 'Подбор эксперта',
        description: 'Рекомендуем профильного специалиста и формируем перечень вопросов для экспертизы.',
        details: [
          'Помогаем выбрать исполнителя исследования, согласовать сроки и подготовить корректные формулировки заданий.',
        ],
        children: [],
      },
    ],
  },
  {
    slug: 'review',
    title: 'Рецензирование заключений',
    description: 'Анализируем сторонние экспертизы и выдаём заключение о корректности методик и выводов.',
    details: [
      'Проверяем каждое утверждение в чужом исследовании, отмечаем нарушения ГОСТов и стандартов, а также даём рекомендации по повторному исследованию.',
    ],
    children: [],
  },
  {
    slug: 'handwriting',
    title: 'Почерковедческая экспертиза',
    description: 'Определяем подпись и почерк, выявляем подделку и оцениваем механизмы нанесения.',
    details: [
      'Исследуем оригиналы и копии, применяем микроскопию и компьютерный анализ, чтобы доказать, кто именно поставил подпись.',
    ],
    promo: {
      title: 'Почерковедческая экспертиза под ключ',
      price: 'от 18 000 ₽',
      description: 'Соберём образцы, проведём анализ и подготовим официальное заключение для суда.',
      backgroundImage: 'https://images.unsplash.com/photo-1509228627152-72ae9ae6848d?auto=format&fit=crop&w=1600&q=80',
    },
    children: [
      {
        slug: 'signature-identification',
        title: 'Идентификация подписи',
        description: 'Устанавливаем, кем выполнена подпись, и есть ли признаки подделки.',
        details: [
          'Сравниваем спорную подпись с образцами, анализируем динамику движений и признаки исполнения под давлением или имитации.',
        ],
        children: [
          {
            slug: 'signature-inking',
            title: 'Исследование способа нанесения',
            description: 'Определяем, наносилась ли подпись в один приём, использовались ли технические средства.',
            details: [
              'Применяем микроскопию и трасологический анализ, чтобы обнаружить следы остановок, двойных штрихов и иных признаков механической подделки.',
            ],
            children: [],
          },
        ],
      },
      {
        slug: 'handwriting-comparison',
        title: 'Сравнение рукописных текстов',
        description: 'Сопоставляем объёмные рукописные тексты и выделяем индивидуальные признаки автора.',
        details: [
          'Проводим графологический анализ, выделяем устойчивые элементы почерка и формулируем вывод о вероятности авторства.',
        ],
        children: [],
      },
    ],
  },
  {
    slug: 'technical-docs',
    title: 'Техническая экспертиза документов',
    description: 'Исследуем бланки, печати, исправления, используем спектральный анализ материалов.',
    details: [
      'Определяем нанесение печатей и штампов, выявляем подмены страниц, анализируем пигменты и химический состав чернил.',
    ],
    promo: {
      title: 'Комплексная проверка документов',
      price: 'от 22 000 ₽',
      description: 'В одном пакете — экспертиза печатей, чернил и бумаги с итоговым отчётом для суда.',
      backgroundImage: null,
    },
    children: [
      {
        slug: 'seal-verification',
        title: 'Проверка печатей и штампов',
        description: 'Выявляем перерисованные или смонтированные оттиски.',
        details: [
          'Сравниваем геометрию и фактуру, анализируем особенности клише и выявляем следы подделки оттисков.',
        ],
        children: [],
      },
      {
        slug: 'ink-analysis',
        title: 'Спектральный анализ чернил',
        description: 'Определяем, использовались ли разные чернила и когда наносился текст.',
        details: [
          'Применяем спектральные и хроматографические методы, чтобы установить состав пасты и оценить давность нанесения.',
        ],
        children: [],
      },
    ],
  },
  {
    slug: 'dating',
    title: 'Экспертиза давности',
    description: 'Определяем примерный срок создания документа или подписи по химическим и физическим признакам.',
    details: [
      'Комбинируем химический анализ и исследование бумаги, чтобы приблизительно определить дату создания документа.',
    ],
    children: [],
  },
  {
    slug: 'construction',
    title: 'Строительная экспертиза',
    description: 'Оцениваем конструктив, материалы и соответствие регламентам, выявляем нарушения при строительстве.',
    details: [
      'Проводим инструментальные обследования, считаем сметы и проверяем соответствие СНиПов, чтобы подтвердить качество работ.',
    ],
    children: [
      {
        slug: 'cost-examination',
        title: 'Проверка смет и подрядчиков',
        description: 'Сопоставляем сметную документацию с фактическими объёмами работ.',
        details: [
          'Анализируем акты, накладные и проектную документацию, рассчитываем экономически обоснованную стоимость.',
        ],
        children: [],
      },
    ],
  },
  {
    slug: 'linguistic',
    title: 'Лингвистическая экспертиза',
    description: 'Анализируем текстовые материалы, устанавливаем смысловые и авторские признаки, фиксируем искажения.',
    details: [
      'Проводим семантический анализ, выделяем признаки авторства и оцениваем наличие экстремистских или дискредитирующих формулировок.',
    ],
    children: [],
  },
  {
    slug: 'it-forensics',
    title: 'Компьютерно-техническая экспертиза',
    description: 'Исследуем цифровые носители, определяем вмешательства, восстанавливаем последовательность событий.',
    details: [
      'Анализируем жёсткие диски, мобильные устройства и логи, чтобы восстановить цепочку действий и выявить следы взлома.',
    ],
    children: [
      {
        slug: 'mobile-forensics',
        title: 'Мобильная экспертиза',
        description: 'Работаем с дампами смартфонов и мессенджерами, восстанавливаем удалённые данные.',
        details: [
          'Используем UFED и собственные методики, чтобы извлечь переписку, медиа и геоданные даже после удаления.',
        ],
        children: [],
      },
      {
        slug: 'log-analysis',
        title: 'Анализ журналов событий',
        description: 'Фиксируем хронологию инцидента по логам серверов и рабочих станций.',
        details: [
          'Коррелируем записи из разных систем, выделяем аномалии и восстанавливаем сценарий атаки.',
        ],
        children: [],
      },
    ],
  },
]

const serviceIndex = new Map()

const enrichTree = (nodes, parentSlug = null, level = 0, parentPath = '') =>
  nodes.map((node) => {
    const children = node.children ?? []
    const path = parentPath ? `${parentPath}/${node.slug}` : node.slug
    const enrichedChildren = enrichTree(children, node.slug, level + 1, path)
    const entry = {
      ...node,
      children: enrichedChildren,
      parentSlug,
      level,
      path,
    }
    serviceIndex.set(path, entry)
    return entry
  })

export const services = enrichTree(servicesTree)

export function findService(pathOrSegments) {
  if (!pathOrSegments) {
    return null
  }

  const normalized = Array.isArray(pathOrSegments)
    ? pathOrSegments.filter(Boolean).join('/')
    : String(pathOrSegments).replace(/^\/+|\/+$/g, '')

  if (!normalized) {
    return null
  }

  return serviceIndex.get(normalized) ?? null
}
